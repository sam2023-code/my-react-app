-- FUNCTION: public.fetch_top_10_login_logs()

-- DROP FUNCTION IF EXISTS public.fetch_top_10_login_logs();

CREATE OR REPLACE FUNCTION public.fetch_top_10_login_logs()
RETURNS TABLE
(
    id INT,
    usertype VARCHAR,
    username VARCHAR,
    login_datetime TIMESTAMP,
    login_datetime_string VARCHAR
) AS $$
BEGIN
    RETURN QUERY
    SELECT 
        ll.id, 
        ll.usertype, 
        ll.username, 
        ll.login_datetime + INTERVAL '8 hours' as login_datetime, 
        TO_CHAR(ll.login_datetime + INTERVAL '8 hours', 'YYYY-MM-DD HH24:MI:SS')::VARCHAR  AS login_datetime_string
    FROM 
        login_log ll
    ORDER BY 
        ll.id DESC
    LIMIT 100;
END;
$$ LANGUAGE plpgsql;

ALTER FUNCTION public.fetch_top_10_login_logs()
    OWNER TO postgres;

